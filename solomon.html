<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nigcel Generator</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin: 0;
        background: linear-gradient(
          90deg,
          #a76e3a,
          #e3c6a0,
          #c89a5e,
          #e3c6a0,
          #c89a5e,
          #e3c6a0,
          #a76e3a
        );
      }

      h1 {
        text-align: center;
        font-family: "Comic Sans MS";
        font-size: 48px;
        color: violet;
        -webkit-text-stroke: 3px black;
      }

      #solomoncontainer {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        background-color: black;
        width: 500px;
        height: 500px;
        border-width: 2px;
      }

      #solomoncontainer img {
        width: 99%;
        height: 99%;
        object-fit: fill;
      }
    </style>
  </head>

  <body>
    <h1>Nigcel generator!!!</h1>
    <div id="solomoncontainer">
      <img id="image" src="res/solomons/solomon.png" />
    </div>
    <button id="changeImageBtn">Change Image</button>

    <script>
      const images = [
        "res/solomons/chillsvrochills.png",
        "res/solomons/chuddy.png",
        "res/solomons/fymthefitisnthard.png",
        "res/solomons/happy.png",
        "res/solomons/hetouchedgrass.png",
        "res/solomons/middlefinger.png",
        "res/solomons/rollie.png",
        "res/solomons/selfie.png",
        "res/solomons/skibidi.png",
        "res/solomons/solomon.png",
        "res/solomons/suicidal.png",
        "res/solomons/whitepower.png",
      ];

      const imageElement = document.getElementById("image");
      const changeImageBtn = document.getElementById("changeImageBtn");

      imageElement.style.transition = "opacity 0.5s";

      // Create a copy of the original images array
      const originalImages = [...images];
      let shuffledImages = [];
      let currentIndex = 0;

      // Function to shuffle an array (Fisher-Yates algorithm)
      function shuffleArray(array) {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
      }

      // Function to preload image and return a promise
      function preloadImage(src) {
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.onload = () => resolve(src);
          img.onerror = reject;
          img.src = src;
        });
      }

      // Initial shuffle
      shuffledImages = shuffleArray(originalImages);

      changeImageBtn.addEventListener("click", async () => {
        // Disable button during transition to prevent multiple clicks
        changeImageBtn.disabled = true;

        // Fade out current image
        imageElement.style.opacity = 0;

        try {
          // Wait for fade out to complete
          await new Promise((resolve) => setTimeout(resolve, 500));

          // If we've gone through all images, reshuffle
          if (currentIndex >= shuffledImages.length) {
            shuffledImages = shuffleArray(originalImages);
            currentIndex = 0;
          }

          const selectedImage = shuffledImages[currentIndex];

          // Preload the new image and wait for it to load
          await preloadImage(selectedImage);

          // Update the image source
          imageElement.src = selectedImage;
          console.log("Changing image to:", selectedImage);

          currentIndex++;

          // Fade in the new image
          imageElement.style.opacity = 1;
        } catch (error) {
          console.error("Error loading image:", error);
          // If error occurs, at least show something
          imageElement.style.opacity = 1;
        } finally {
          // Re-enable the button
          changeImageBtn.disabled = false;
        }
      });

      // Show first image immediately (optional)
      if (shuffledImages.length > 0) {
        imageElement.src = shuffledImages[0];
        currentIndex = 1;
      }
    </script>

    <h1>those who know: ðŸ’€</h1>
    <h1>test</h1>
  </body>
</html>
